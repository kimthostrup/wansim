{% extends "layout.html" %}
{% block body %}
  <!-- Page Heading -->

  <div class="row">
      <div class="col-lg-12 text-center">
          <h1 class="page-header">
              Latency Settings
          </h1>
      </div>
  </div>
  <!-- /.row -->


  <form class="form-horizontal" action="{{ url_for('tc_latency') }}" method="post" role="form">
    <div class="form-group">
      <label for="lc" class="col-sm-4 control-label">Delay in ms:</label>
      <div class="col-sm-2">
        <input type="number" class="form-control" name="lc" id="lc" value="{{ delay }}">
      </div>
      <div class="col-sm-6">
        <input id="latency" data-slider-id='latency-slider' type="number" data-slider-min="0" data-slider-max="2000" data-slider-step="50" data-slider-value="{{ delay }}" data-slider-tooltip="hide"/>
      </div>
    </div>
    <div class="form-group">
      <label for="va" class="col-sm-4 control-label">Jitter in ms:</label>
      <div class="col-sm-2">
        <input type="number" class="form-control" name="va" id="va" value="{{ jitter }}">
      </div>
      <div class="col-sm-6">
        <input id="variation" data-slider-id='variation-slider' type="number" data-slider-min="0" data-slider-max="250" data-slider-step="25" data-slider-value="{{ jitter }}" data-slider-tooltip="hide"/>
      </div>
    </div>
    <div class="form-group">
      <label for="va" class="col-sm-4 control-label">Correlation in %:</label>
      <div class="col-sm-2">
        <input type="number" class="form-control" name="app" id="app" value="{{ delcorr }}">
      </div>
      <div class="col-sm-6">
        <input id="approx" data-slider-id='approx-slider' type="number" data-slider-min="0" data-slider-max="100" data-slider-step="10" data-slider-value="{{ delcorr }}" data-slider-tooltip="hide"/>
      </div>
    </div>
    <div class="form-group">
      <div class="col-sm-6">
        {% if not bridgeActive %}
          <span class="tool-tip btn-block" data-toggle="tooltip" data-placement="top" title="Please create a bridge">
        {% endif %}
            <button type="submit" class="btn btn-primary btn-block {% if not bridgeActive %}disabled{% endif %}" {% if not bridgeActive %}disabled{% endif %} name="action" value="set">Set</button>
        {% if not bridgeActive %}
          </span>
        {% endif %}
      </div>
      <div class="col-sm-6">
        {% if not bridgeActive %}
          <span class="tool-tip btn-block" data-toggle="tooltip" data-placement="top" title="Please create a bridge">
        {% endif %}
            <button type="submit" class="btn btn-danger btn-block {% if not bridgeActive %}disabled{% endif %}" {% if not bridgeActive %}disabled{% endif %} name="action" value="reset">Reset</button>
        {% if not bridgeActive %}
          </span>
        {% endif %}
      </div>
    </div>
  </form>

  <script type="text/javascript">
    var latval = 0;
    var vaval = 0;
    var appval = 0;

    window.onload = function () {
      if ("{{ bridgeActive }}" == "False"){
        $('[data-toggle="tooltip"]').tooltip()
      }

      var latSlider = $('#latency').slider({
      	formatter: function(value) {
          if (value != latval) {
            //console.log('Current value: ' + value);
            latval = value;
            $("#lc").val(value);
          }
      		return 'Current value: ' + value;
      	}
      });
      var vaSlider = $('#variation').slider({
      	formatter: function(value) {
          if (value != vaval) {
            //console.log('Current value: ' + value);
            vaval = value;
            $("#va").val(value);
          }
      		return 'Current value: ' + value;
      	}
      });
      var appSlider = $('#approx').slider({
      	formatter: function(value) {
          if (value != appval) {
            //console.log('Current value: ' + value);
            appval = value;
            $("#app").val(value);
          }
      		return 'Current value: ' + value;
      	}
      });

      $("#lc").on("change paste keyup", function() {
        var val = parseInt($("#lc").val());
        latSlider.slider("setValue", val);
      });
      $("#va").on("change paste keyup", function() {
        var val = parseInt($("#va").val());
        vaSlider.slider("setValue", val);
      });
      $("#app").on("change paste keyup", function() {
        var val = parseInt($("#app").val());
        appSlider.slider("setValue", val);
      });
    };
  </script>

{% endblock %}
